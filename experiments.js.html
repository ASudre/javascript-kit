<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: experiments.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: experiments.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>(function (Global, undefined) {

    "use strict";

    var COOKIE_NAME = "io.prismic.experiment";

    /**
     * A collection of experiments currently available
     * @param data the json data received from the Prismic API
     * @constructor
     */
    function Experiments(data) {
        var drafts = [];
        var running = [];
        if (data) {
            data.drafts &amp;&amp; data.drafts.forEach(function (exp) {
                drafts.push(new Experiment(exp));
            });
            data.running &amp;&amp; data.running.forEach(function (exp) {
                running.push(new Experiment(exp));
            });
        }
        this.drafts = drafts;
        this.running = running;
        this.cookieName = COOKIE_NAME;
    }

    Experiments.prototype.current = function() {
        return this.running.length > 0 ? this.running[0] : null;
    };

    /**
     * Get the current running experiment variation ref from a cookie content
     */
    Experiments.prototype.refFromCookie = function(cookie) {
        if (!cookie || cookie.trim() === "") return null;
        var splitted = cookie.trim().split("%20");
        if (splitted.length &lt; 2) return null;
        var expId = splitted[0];
        var varIndex = parseInt(splitted[1], 10);
        this.running.forEach(function(exp) {
            if (exp.googleId() == expId) {
                return (exp.variations.length > varIndex) ? exp.variations[varIndex] : null;
            }
        });
        return null;
    };

    function Experiment(data) {
        this.data = data;
        var variations = [];
        data.variations &amp;&amp; data.variations.forEach(function(v) {
            variations.push(new Variation(v));
        });
        this.variations = variations;
    }

    Experiment.prototype.id = function() {
        return this.data.id;
    };

    Experiment.prototype.googleId = function() {
        return this.data.googleId;
    };

    Experiment.prototype.name = function() {
        return this.data.name;
    };

    function Variation(data) {
        this.data = data;
    }

    Variation.prototype.id = function() {
        return this.data.id;
    };

    Variation.prototype.ref = function() {
        return this.data.ref;
    };

    Variation.prototype.label = function() {
        return this.data.label;
    };

    Global.Prismic.Experiments = Experiments;
    Global.Prismic.Experiment = Experiment;
    Global.Prismic.Variation = Variation;

}(typeof exports === 'object' &amp;&amp; exports ? exports : (typeof module === "object" &amp;&amp; module &amp;&amp; typeof module.exports === "object" ? module.exports : window)));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Api.html">Api</a></li><li><a href="Doc.html">Doc</a></li><li><a href="Color.html">Fragments:Color</a></li><li><a href="Date.html">Fragments:Date</a></li><li><a href="DocumentLink.html">Fragments:DocumentLink</a></li><li><a href="Embed.html">Fragments:Embed</a></li><li><a href="FileLink.html">Fragments:FileLink</a></li><li><a href="GeoPoint.html">Fragments:GeoPoint</a></li><li><a href="Group.html">Fragments:Group</a></li><li><a href="ImageEl.html">Fragments:ImageEl</a></li><li><a href="ImageLink.html">Fragments:ImageLink</a></li><li><a href="ImageView.html">Fragments:ImageView</a></li><li><a href="Num.html">Fragments:Num</a></li><li><a href="Select.html">Fragments:Select</a></li><li><a href="StructuredText.html">Fragments:StructuredText</a></li><li><a href="Text.html">Fragments:Text</a></li><li><a href="Timestamp.html">Fragments:Timestamp</a></li><li><a href="WebLink.html">Fragments:WebLink</a></li><li><a href="LinkedDocument.html">LinkedDocument</a></li><li><a href="Ref.html">Ref</a></li><li><a href="Response.html">Response</a></li><li><a href="SearchForm.html">SearchForm</a></li></ul><h3>Namespaces</h3><ul><li><a href="Predicates.html">Predicates</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Fri Oct 24 2014 16:07:04 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
